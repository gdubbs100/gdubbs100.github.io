---
overview: "Have a look at a distribution without a defined mean and how it can be applied to electricity spot prices"
---
# Exploring the Cauchy distribution and electricity spot prices

For a while now I've been fascinated by a probability distribution known as the Cauchy distribution. I'd first learnt about it through reading the books of Nicholas Nassim Taleb and later Benoit Mandelbrot. Both of whom discuss the distribution in the context of financial risk.

The reason the Cauchy distribution is so fascinating is because it does not have a defined mean or variance. Essentially, if you sample from a Cauchy distribution, no matter how many samples you have, calculating the mean or variance of this distribution will not converge to a single value, contravening the central limit theorem. This is in stark contrast to distributions like the Gaussian, for which a rule of thumb is that 30 observations would give you a good estimate of its true parameters. Furthermore, the Cauchy distribution is no mathematical curio, it <a href="https://en.wikipedia.org/wiki/Cauchy_distribution#Occurrence_and_applications">occurs in the real world</a> in applications such as physics and finance.

With this in mind, I'm going to explore the properties of the Cauchy distribution and look at how it can be applied to Australian electricity spot-prices using a model developed by Powell [CITE].

## What is the Cauchy distribution
As discussed above, the Cauchy distribution is a probability distribution with undefined mean and variance. The probability density function is defined as:

$$
f(x|x_{0}, \gamma) = \frac{1}{\pi}\frac{\gamma}{(x - x_{0})^2 + \gamma^2}
$$

Where $x_{0}$ is the location parameter, giving the centre of the distribution and $\gamma$ is the scale parameter which is effectively the variance. Interestingly, with $x_{0} = 0, \lambda = 1$, the Cauchy distribution is identical to the student's t-distribution with one degree of freedom (i.e. for two observations). This distribution can also be realised as the ratio of two independent Standard Gaussian distributions.

Below I've sampled from $Cauchy(x_{0} = 0,\lambda = 1)$ and $Normal(\mu = 0,\sigma^{2} = 1)$ distributions $10,000$ observations and estimated the mean and standard on a rolling basis. The plot shows how the estimates of scale and location vary significantly for the Cauchy distribution. 
On the left, after some initail volatility, the cauchy location estimate appears to approach the true location (0), but suddenly jumps at around $x=5,000$ and fails to return to 0. In contrast, the Normal distribution quickly reaches almost exactly 0 and stays there as more samples are accumulated. On the right, the result is even worse - the estimate of location increases to over $100$, while the estimate for the normal sits nicely at 1 - the true value.

![Cauchy vs Normal Parameter Estimates](../../../images/20260221Cauchy/cauchy_behaviour.png)

What this highlights, is that using the typical methods of estimating parameters like the location, that can work well for Gaussian, Exponential, Poisson and other distributions with finite mean/variance, does not work well for the Cauchy. Naturally - there are a variety of ways of fitting the parameters of the Cauchy distribution. Maximum likelihood estimation is one way. In the above, we use the MLE estimate of the parameters if the distribution was Gaussian - and unsurprisingly it didn't work. An even simpler way is to treat the location parameter as the median of the distribution and the scale as the inter-quartile range. Quantile estimates are less responsive to the extreme outliers that occur in the Cauchy distribution, hence they are more stable. The below plot compares these estimates for the same data and the same Gaussian mean/std estimates. You can see that both are much more stable and appear to reach the true value and remain stable. 

![Cauchy median/iqr Parameter Estimates](../../../images/20260221Cauchy/cauchy_median_iqr.png)

## The Cauchy Distribution and Electricity Spot Prices
Observing this strange behaviour made me curious - it is all well and good observing this behaviour in the above simple setup, but what about in the real world? In a sample of data taken from the real world, could you really see this kind of non-convergent behaviour? 

I found one such instance in a paper by Warren Powell [^1], where he analyses electricity prices in the US and finds that the Cauchy distribution is a good fit for modelling the error term of a median-reverting model of hourly spot prices. I'll explain more details in a moment. But I decided to get some Australian data and see if I could replicate the model and view the Cauchy distribution in the wild.

Using the OpenElectricity API [^2] I was able to extract hourly electricty spot price data for NSW. Exactly the sort of data used by Powell in his paper. Plotting this price data below, we can see that the pric behaviour is highly volatile with extreme spikes, and this affects the estimation of the mean. The mean estimate appears not to converge and be sensitive to sudden spikes, much like our simulated data above. 

Over the course of the year, the trend electricity price may fluctuate due to seasonality, and this may mean we see a change in the mean. But note, the types of changes we observe in the mean estimate are sudden and large, and they correlate with the extreme jumps in price (price spikes are the 99.5th percentile price observations). This suggests that the reason for not converging is not due to seasonality but rather the heavy tailed nature of the electricity prices. This is not to say there are no seasonal impacts on price - just that the instability in the mean estimate is not driven by them.

![NSW price behaviour](../../../images/20260221Cauchy/nsw_price_behaviour.png)

### A Median Reversion Model of Electricity Prices

Powell and Kim develop a model of hourly electricity spot prices which assumes that prices revert towards the median [^1]. Their objective is to accurately model the tails of the price distribution to enable effective trading in the energy market. Their model follows the below equation:

$$
p_{t+1} = p_{t} + (1 - \kappa) (p_{t} - \mu_{t}) \hat{\epsilon_{t}}
$$

Where $ \kappa = (1 - \bar{\mu\_{Y}}) $ ; 
$ \mu\_{t} $ is a trailing monthly price median which accounts for potential seasonal variation in prices; $ \bar{\mu_{Y}} = median({Y_{t}}) $, $Y_{t}$ is the residual term, and $ \hat{\epsilon_{t}} $ is the error term which is applied multiplicatively to the median reversion term. Essentially, this model assumes that there is large uncertainty when the current price has deviated from the rolling monthly median. Naturally, the use of the median is driven by their analysis of the electricity prices where they observe a non-convergent mean.

It is worth looking at the residual $Y_{t}$ and error term $ \hat{\epsilon_{t}} $.

$$
Y_{t} = \frac{(p_{t} - p_{t - 1})}{(p_{t} - \mu_{t})}
$$

Which is the ratio of the change in price to the deviation of price from the trailing median. Note that for the next step ahead prediction, $1 - \kappa = 1 - (1 - \mu_{Y}) = \mu_{Y}$ which implies that the strength of the median reversion is governed by the median value of the residual. That is, the median ratio of price changes to the difference between the price to the median monthly price is an estimate of how much pull there is back to the median price. If we have small price changes relative to that prices distance from the median, then there is only a small pull back to the median, in contrast if the changes are large, then there is a strong pull back to the centre.

The error term is given by:

$$
\hat{\epsilon_{t}} = \frac{Y_{t}}{\mu_{Y}}
$$

This is the term that Powell and Kim [^1] suggest is governed by a Cauchy distribution. In their paper, they estimate the tail parameter $\alpha$ and find that it is close to 1, implying infinite variance. I've simply done a comparison here against a QQ-plot looking at the actaul data vs a Cauchy distribution with $x_0 = 1$ and $\gamma \approx 5.23$. I've also estimated a Gaussian with $\mu \approx -3.5$ and $\sigma \approx 911$ (naively, without removing outliers). You can see clearly that the Cauchy distribution fits significantly better than the Gaussian, although it still has some discrepancies for the large tail values. In particular, the Cauchy distribution appears to have more extreme tails than the actual data.

<div style="display: flex; justify-content: space-between; gap: 10px;">
  <figure style="width: 48%; text-align: center;">
    <img src="{{ '/images/20260221Cauchy/qq_cauchy_train.png' | relative_url }}" alt="Cauchy QQ Plot">
    <figcaption><b>QQ Plot for a fitted Cauchy distribution</b></figcaption>
  </figure>
  
  <figure style="width: 48%; text-align: center;">
    <img src="{{ '/images/20260221Cauchy/qq_normal_train.png' | relative_url }}" alt="Gaussian QQ Plot">
    <figcaption><b>QQ Plot for a fitted Normal distribution</b></figcaption>
  </figure>
</div>

Quantile distributions of $Y$ show a good match as well (this is how Powell and Kim present their model fit before concluding the paper). Here I've include a Gaussian distribution with outliers +/- 3 standard deviations removed, as well as the naive estimate with all data. You can see, the Cauchy quantiles match nicely with the actual distribution, while the Gaussian distributions are far from the mark around the tails. Essentially, while the variance is clearly large - the spread of prices between the 90th and 10th quantiles is over $2,000 for the naive estimate - the Gaussian distributions fail to account for the fact that there are massive _rare_ events. They just assume that 80% of prices will be somewhere between +/- $1,000. This is not very specific and does not reflect the true distribution of prices.

$$
\small
\begin{array}{|l|c|c|c|c|c|c|c|c|c|}
\hline
\text{Distribution/Quantile} & 0.1 & 0.2 & 0.3 & 0.4 & 0.5 & 0.6 & 0.7 & 0.8 & 0.9 \\ \hline
\textbf{Actual} & -15.998 & -6.245 & -2.562 & -0.503 & 1.016 & 2.711 & 4.807 & 8.089 & 17.546 \\ \hline
\text{Cauchy} & -15.108 & -6.204 & -2.802 & -0.701 & 1.000 & 2.701 & 4.802 & 8.204 & 17.108 \\ \hline
\text{Gaussian (All Data)} & -1171.762 & -770.723 & -481.545 & -234.454 & -3.503 & 227.447 & 474.539 & 763.716 & 1164.755 \\ \hline
\text{Gaussian (Filtered)} & -143.314 & -93.772 & -58.049 & -27.524 & 1.006 & 29.536 & 60.060 & 95.784 & 145.325 \\ \hline

\end{array}
$$

We can see this better when we look at actual prices. Note - I've split the data into test and train. The model parameters (i.e. $\bar{\mu}_Y$) was estimated on NSW electricity price data between 1 Jan 2025 and 31 Dec 2025, while the test set ranges from 1 Jan 2026 to Mid-Feb 2026. [FIX THIS] Above I plotted training values - although there is very little difference. 

Below we plot a snapshot of the training data around a price spike on the evening of 10 Jan 2026. The predicted price is the same for both models - using the reverting median. The distribution around the prices varies using the distributions we estimated before. As we saw in the quantile plot above, the Gaussian distribution has unrealistically large tails. Almost every observation occurs within the IQR of the Gaussian distribution - which should truly only have 50% of the observations. In contrast, the Cauchy distribution actually has narrower tails, but these capture the data better - most of the time the price distribution is narrowly peaked around the actual prices, but it spreads out when there are large deviations from the median.

<div style="justify-content: space-between; gap: 10px;">
  <figure style="width: 100%; text-align: center;">
    <img src="{{ '/images/20260221Cauchy/filtered_data_gaussian_test.png' | relative_url }}" alt="Gaussian (filtered data) Error Price Model">
    <figcaption><b>Gaussian (filtered data) Error Price Model</b></figcaption>
  </figure>
  
  <figure style="width: 100%; text-align: center;">
    <img src="{{ '/images/20260221Cauchy/cauchy_test.png' | relative_url }}" alt="Cauchy Error Price Model">
    <figcaption><b>Cauchy Error Price Model</b></figcaption>
  </figure>
</div>

The below table shows how accurate the probability estimate of price is when errors are modelled with a Cauchy distribution. In contrast, the Gaussian distribution thinks that almost _everything_ should fall within the IQR. It over-states the probability of events occurring because it is highly responsive to the outliers in the data. This is a bit counter-intuitive as the reason for using a Cauchy distribution is that it has fatter tails. Part of this difference may be due to the fact we are applying the Gaussian error term to a median-reverting model which already accounts for the extreme nature of the prices by using median rather than mean. But the Gaussian tails are incorrectly specified, as they assign a higher probability than observed to almost all prices. The Cauchy distribution assigns more accurate probabilities, as shown in the below table.

$$
\begin{array}{|l|c|c|c|c|}
\hline
\text{Distribution} & \text{Test in IQR} & \text{Train in IQR} & \text{Test in 95 CI} & \text{Train in 95 CI} \\ \hline
\text{Cauchy} & 0.500 & 0.499 & 0.938 & 0.938  \\ \hline
\text{Gaussian (All)} & 0.989 & 0.991 & 0.993 & 0.996  \\ \hline
\text{Gaussian (Filt)} & 0.941 & 0.944 & 0.983 & 0.977 \\ \hline
\end{array}
$$

## Conclusion 
So we have seen that despite their unusual properties of not having means or variances, the Cauchy distribution does occur in real world circumstances and can be applied. One thing I'd be interested in learning more about is how to use a model such as the one implemented above. As it was designed for energy trading, I think it would be interesting to understand what strategies it could be used for. The first thing that comes to mind is for buying low / selling high with a probabilitistic forecast of future prices. But I do note - while the Cauchy model appears to have accurate predictions, based on the plot shown above, it still seems to miss some outliers entirely. Could that result in large losses?

## References
[^1]: Kim, J. H., & Powell, W. B. (2011). An hour-ahead prediction model for heavy-tailed spot prices. *Energy Economics*, 33(6), 1252-1266. https://doi.org/10.1016/j.eneco.2011.06.007
[^2]: **Open Electricity.** (2024). *OpenElectricity API and Platform*. The Superpower Institute. Available at: [https://openelectricity.org.au](https://openelectricity.org.au) (Accessed: 24 February 2025).
